<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</head>
<body>
	<div class="container">
		<div class="row">
			<div class="col-12" style="text-align: center;">
				<h3>Salida de Repuestos de Almacen</h3>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-6">
			<img src="logo.png" style="width: 150px;">
		</div>
		<div class="col-6" style="text-align: right;">
			<h5>TIPO DE OT: GARANTIA</h5>
			<h5>OT 001 - <input id="codigogarantia" type="text" name="" style="text-align:right; width: 90px;"></h5>
		</div>
	</div>
	<div class="row" id="tabladatos">
		<div class="col-6" style="border-color: black; border-width: 1px; border-style: solid;">
			<h6>PLACA:</h6>
			<h6>CHASIS:</h6>
			<h6>KILOMETRAJE:</h6>
			<h6>FECHA:</h6>
		</div>
		<div class="col-6" style="border-color: black; border-width: 1px; border-style: solid;">
			<h6>PROPIETARIO:</h6>
			<h6>DOCUMENTO:</h6>
			<h6>DIRECCION:</h6>
		</div>
		<div class="col-12" style="border-color: black; border-width: 1px; border-style: solid;">
			<h6>MARCA:</h6>
			<h6>MODELO:</h6>
			<h6>COLOR:</h6>
		</div>
	</div>
	<div class="row">
		<div class="col-12">
			<table border="1" class="table" id="tablaprueba">
		      <thead class="thead-dark">
		        <tr>
		          <th width="10%">STOCK</th>
		          <th width="10%">CODIGO</th>
		          <th width="10%">CANT.</th>
		          <th width="75%">DESCRIPCION</th>
		        </tr>
		      </thead>
		      <tbody></tbody>
		    </table>
		    
		    <button type="button" class="btn" onclick="agregarFila()">+</button>
      		<button type="button" class="btn" onclick="eliminarFila()">-</button>

      		<script type="text/javascript">
      			let contador = 1;
      			const agregarFila = () => {
				  document.getElementById('tablaprueba').insertRow(-1).innerHTML = '<tr>'+
				  '<td>'+
				  '<select style="">'+
				  '<option>GM</option>'+
				  '<option>NO GM</option>'+
				  '</select>'+
				  '</td>'+
				  '<td><input id="valorCodigo'+contador+'" onkeyup="BuscarCodigo('+contador+');" style="width: 100px; type="text" name=""></td>'+
				  '<td><input type="text" name="" style="width: 50px"></td>'+
				  '<td><input id="valorDescripcion'+contador+'" type="text" name="" style="width: 100%; font-size:13px"></td>'+
				  '</tr>'

				  contador++;
				}


				function BuscarCodigo(contador){
                  var valorCodigo = $('#valorCodigo'+contador).val();
                      $.ajax({
                          url: 'CargarCodigos.php',
                          type: 'POST',
                          data: {
                              'valorCodigo':valorCodigo
                          },
                          beforeSend: function(){
                              //alerta('info','Cargando la info!!!')
                              // $('#contenido').css("display", "none");
                              // $('#loader').css("display", "block");
                          }
                          })
                          .done(function(res){
                              const datoscodigo = JSON.parse(res);
                              // $("#InputCliente").val(datoscodigo.idListaCodigo);
                              //$("#InputDireccion").val(datoscodigo.codListaCodigo);
                              $("#valorDescripcion"+contador).val(datoscodigo.descripcion);
                              
                          })
                          .fail(function(){
                              //alerta('error','Hoo Noo!!!')
                          })
                          .always(function(){
                              //console.log("complete");
                      })
                }

				const eliminarFila = () => {
				  const table = document.getElementById('tablaprueba')
				  const rowCount = table.rows.length
				  
				  if (rowCount <= 1)
				    alert('No se puede eliminar el encabezado')
				  else
				    table.deleteRow(rowCount -1)
				}

      		</script>
		</div>
	</div>

	<script type="text/javascript">
		var elInput = document.getElementById('codigogarantia');
		elInput.addEventListener('keyup', function(e) {
		  var keycode = e.keyCode || e.which;
		  if (keycode == 13) {
		    BuscarGarantia();
		  }
		});

		function BuscarGarantia(){
          var codigogarantia = $('#codigogarantia').val();
            $.ajax({
              url: 'ConsultaGarantia.php',
              type: 'POST',
              data: {
                  'codigogarantia':codigogarantia
              },
              beforeSend: function(){
                  //alerta('info','Cargando la info!!!')
                  // $('#contenido').css("display", "none");
                  // $('#loader').css("display", "block");
              }
              })
              .done(function(res){
                  // $('#contenido').css("display", "block");
                  // $('#loader').css("display", "none")
                  $('#tabladatos').html(res)
                  //$("#tabladatos").val(res);
        
              })
              .fail(function(){
                  //alerta('error','Hoo Noo!!!')
              })
              .always(function(){
                  //console.log("complete");
          })
        }
	</script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</body>
</html>